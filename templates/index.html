<!-- ë¸Œë¼ìš°ì €ì— ë³´ì—¬ì§€ëŠ” í™”ë©´ -->
<!DOCTYPE html>
<html lang="ko">

<head>
	<!-- ë¸Œë¼ìš°ì € íƒ­ ì œëª© -->
	<title> í•´í”¼ë‹ˆìŠ¤ ì±—ë´‡ </title>

	<!-- flaskê°€ static í´ë” ì•ˆì— style.css ì°¾ì•„ì„œ ì—°ê²° --> 
	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <!-- ì±—ë´‡ UI ì „ì²´ë¥¼ ê°ì‹¸ëŠ” ì»¨í…Œì´ë„ˆ -->
    <div class="chat-container">

        <!-- í™”ë©´ ìƒë‹¨ì˜ ì œëª© -->
	<h1>ì•ˆë…•! MZ ë„ˆì˜ ë¯¸ë˜ë¥¼ ì„¤ê³„í•´ë´ ğŸ¤–</h1>

        <!-- ì±„íŒ… ë©”ì‹œì§€ë“¤ì´ í‘œì‹œë  ì˜ì—­ -->
        <div id="chat-box"></div>

        <!-- ì‚¬ìš©ì ë©”ì‹œì§€ ì…ë ¥ì°½ -->
        <input type="text" id="user-input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">

        <!-- ë©”ì‹œì§€ ì „ì†¡ ë²„íŠ¼: í´ë¦­ ì‹œ sendMessage() ì‹¤í–‰ -->
        <button onclick="sendMessage()">ë³´ë‚´ê¸°</button>
 
    <!-- JavaScriptë¡œ ì±—ë´‡ ê¸°ëŠ¥ ì²˜ë¦¬ -->
    <script>
    // í˜ì´ì§€ ë¡œë“œëœ í›„ ì‹¤í–‰ë˜ê²Œ ì„¤ì •
    window.onload = function () {
        function sendMessage() {
            // ì…ë ¥ì°½ì—ì„œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì˜´
            const userInput = document.getElementById("user-input").value;

            // ì±„íŒ… ë°•ìŠ¤ DOM ìš”ì†Œ
            const chatBox = document.getElementById("chat-box");

            // ì‚¬ìš©ì ë§í’ì„ 
            chatBox.innerHTML += `<div class="message user-message">${userInput}</div>`;

            // Flask ì„œë²„ë¡œ ë©”ì‹œì§€ ì „ì†¡ (POST ìš”ì²­)
            fetch("/get", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ message: userInput })
            })
            .then(response => response.json()) // ì„œë²„ ì‘ë‹µì„ JSONìœ¼ë¡œ ë°›ìŒ
            .then(data => {
                // ì±—ë´‡ ë§í’ì„ 
                chatBox.innerHTML += `<div class="message bot-message">${data.response}</div>`;

                // ì…ë ¥ì°½ ë¹„ìš°ê¸°
                document.getElementById("user-input").value = "";

                // ì±„íŒ…ì°½ ìŠ¤í¬ë¡¤ì„ ê°€ì¥ ì•„ë˜ë¡œ ë‚´ë¦¬ê¸°
                chatBox.scrollTop = chatBox.scrollHeight;
            });
        }

    // ì—”í„°í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
    document.getElementById("user-input").addEventListener("keydown", function (e) {
        if (e.key === "Enter") {
            sendMessage();
        }
    });

        // ë²„íŠ¼ í´ë¦­ ì‹œ ë©”ì‹œì§€ ì „ì†¡
        document.querySelector("button").addEventListener("click", sendMessage);
    };
    </script>
</body>
</html>
